"use strict";(self.webpackChunkemind=self.webpackChunkemind||[]).push([[3240],{68470:function(e,n,t){t(72791);var r=t(80184),a=function(e){var n=e.children,t=e.className,a=e.alignItems,i=e.justifyContent,s=e.mobileFlex,d=e.flexDirection;return(0,r.jsx)("div",{className:"".concat(s?"d-flex":"d-md-flex"," ").concat(t," ").concat(d?"flex-"+d:""," ").concat(a?"align-items-"+a:""," ").concat(i?"justify-content-"+i:""),children:n})};a.defaultProps={mobileFlex:!0,flexDirection:"row",className:""},n.Z=a},68120:function(e,n,t){t.d(n,{$h:function(){return N},H1:function(){return v},L8:function(){return I},S8:function(){return _},Xc:function(){return T},_W:function(){return B},d3:function(){return C},d6:function(){return F},ey:function(){return q},fJ:function(){return S},iF:function(){return D},kk:function(){return M},sF:function(){return V},ux:function(){return w},yC:function(){return A},zX:function(){return b}});var r,a,i,s,d,c,l,o,u,m,k,g,f,p,x,Z,$,h,j,y=t(30168),P=t(27570),I=(0,P.Ps)(r||(r=(0,y.Z)(["\n    query allMarks ($markBoard: Int!) {\n        allMarks (markBoard: $markBoard) {\n            id\n            student {\n                id\n                familyName\n                name\n                studentCode\n            }\n            markRelSet {\n                markVal\n                markSetting {\n                    id\n                    name\n                }\n            }\n            markBoard {\n                subject {\n                    subject\n                }\n            }\n        }\n    }\n"]))),S=(0,P.Ps)(a||(a=(0,y.Z)(["\n    mutation createMark ($section: Int, $studentCode: String, $markBoard: Int) {\n        createMark (section: $section, studentCode: $studentCode, markBoard: $markBoard) {\n            mark {\n                id\n            }\n        }\n    }\n"]))),b=(0,P.Ps)(i||(i=(0,y.Z)(["\n    mutation deleteMark ($id: ID) {\n        deleteMark (id: $id) {\n            mark {\n                student {\n                    id\n                }\n            }\n        }\n    }\n"]))),M=(0,P.Ps)(s||(s=(0,y.Z)(["\n    mutation createMarkRel ($mark: Int, $markSetting: Int, $markVal: String) {\n        createMarkRel (mark: $mark, markSetting: $markSetting, markVal: $markVal) {\n            markRel {\n                id\n                markVal\n                markSetting {\n                    id\n                    name\n                }\n            }\n        }\n    }\n"]))),v=((0,P.Ps)(d||(d=(0,y.Z)(["\n    query allMarkRels ($mark: Int!) {\n        allMarkRels (mark: $mark) {\n            mark {\n                student {\n                    id\n                    studentCode\n                }\n            }\n            markSetting {\n                name\n                percentage\n            }\n            markVal\n        }\n    }\n"]))),(0,P.Ps)(c||(c=(0,y.Z)(["\n    query allMarkPercentages {\n        allMarkPercentages {\n            id\n            type\n            percentage\n            diam\n        }\n    }\n"])))),A=(0,P.Ps)(l||(l=(0,y.Z)(["\n    mutation createMarkPercentage ($diam: String, $percentage: Int, $type: String) {\n        createMarkPercentage (diam: $diam, percentage: $percentage, type: $type) {\n            markPercentage {\n                type\n            }\n        }\n    }\n"]))),C=(0,P.Ps)(o||(o=(0,y.Z)(["\n    mutation updateMarkPercentage ($diam: String, $percentage: Int, $type: String, $id: ID) {\n        updateMarkPercentage (diam: $diam, percentage: $percentage, type: $type, id: $id) {\n            markPercentage {\n                type\n            }\n        }\n    }\n"]))),B=(0,P.Ps)(u||(u=(0,y.Z)(["\n    mutation deleteMarkPercentage ($id: ID) {\n        deleteMarkPercentage (id: $id) {\n            markPercentage {\n                type\n            }\n        }\n    }\n"]))),T=((0,P.Ps)(m||(m=(0,y.Z)(["\n    query markBoardById ($id: Int!) {\n        markBoardById (id: $id) {\n            id\n            schoolyear {\n                id\n                schoolyear\n            }\n            subject {\n                id\n                subject\n            }\n            teacher {\n                id\n                name\n            }\n            startAt \n            endAt\n            status\n            createdAt\n            updatedAt\n        }\n    }\n"]))),(0,P.Ps)(k||(k=(0,y.Z)(['\n    query allMarkBoards ($offset: Int!, $limit: Int!, $filter: String) {\n        count (appName: "mark", modelName: "Mark_board", filter: $filter) {\n            count\n        }\n        allMarkBoards (offset: $offset, limit: $limit, filter: $filter) {\n            id\n            schoolyear {\n                id\n                schoolyear\n            }\n            subject {\n                id\n                subject\n            }\n            teacher {\n                id\n                name\n            }\n            startAt \n            endAt\n            status\n            createdAt\n            updatedAt\n        }\n    }\n'])))),F=((0,P.Ps)(g||(g=(0,y.Z)(["\n    mutation createMarkBoardFromRoutine ($endAt: String, $routine: Int, $startAt: String, $status: String) {\n        createMarkBoardFromRoutine (endAt: $endAt, routine: $routine, startAt: $startAt, status: $status) {\n            markBoard {\n                id\n            }\n        }\n    }\n"]))),(0,P.Ps)(f||(f=(0,y.Z)(["\n    mutation createMarkBoard ($endAt: String, $schoolyear: Int, $startAt: String, $status: String, $subject: Int, $teacher: Int) {\n        createMarkBoard (endAt: $endAt, schoolyear: $schoolyear, startAt: $startAt, status: $status, subject: $subject, teacher: $teacher) {\n            markBoard {\n                id\n            }\n        }\n    }\n"])))),w=(0,P.Ps)(p||(p=(0,y.Z)(["\n    mutation updateMarkBoard ($endAt: String, $schoolyear: Int, $startAt: String, $status: String, $subject: Int, $teacher: Int, $id: ID) {\n        updateMarkBoard (endAt: $endAt, schoolyear: $schoolyear, startAt: $startAt, status: $status, subject: $subject, teacher: $teacher, id: $id) {\n            markBoard {\n                id\n            }\n        }\n    }\n"]))),D=(0,P.Ps)(x||(x=(0,y.Z)(["\n    mutation deleteMarkBoard ($id: ID) {\n        deleteMarkBoard (id: $id) {\n            markBoard {\n                startAt\n            }\n        }\n    }\n"]))),N=(0,P.Ps)(Z||(Z=(0,y.Z)(["\n    query allMarkSettings {\n        allMarkSettings {\n            id\n            name\n            percentage\n            createdAt\n            updatedAt\n        }\n    }\n"]))),q=(0,P.Ps)($||($=(0,y.Z)(["\n    mutation createMarkSetting ($name: String, $percentage: Int) {\n        createMarkSetting (name: $name, percentage: $percentage) {\n            markSetting {\n                id\n            }\n        }\n    }\n"]))),_=(0,P.Ps)(h||(h=(0,y.Z)(["\n    mutation updateMarkSetting ($name: String, $percentage: Int, $id: ID) {\n        updateMarkSetting (name: $name, percentage: $percentage, id: $id) {\n            markSetting {\n                id\n            }\n        }\n    }\n"]))),V=(0,P.Ps)(j||(j=(0,y.Z)(["\n    mutation deleteMarkSetting($id: ID) {\n        deleteMarkSetting (id: $id) {\n            markSetting {\n                name\n            }\n        }\n    }\n"])))},23240:function(e,n,t){t.r(n),t.d(n,{default:function(){return w}});var r=t(72791),a=t(29439),i=t(20003),s=t(50419),d=t(87309),c=t(66871),l=t(49389),o=t(59432),u=t(37083),m=t(69421),k=t(36795),g=t(82464),f=t(11730),p=t(31549),x=t(68470),Z=t(2703),$=t(73332),h=t(66106),j=t(30914),y=t(76835),P=t(84376),I=t(68747),S=t(79286),b=t(68120),M=t(82630),v=t(80184);var A=function(e){var n=e.formType,t=e.editData,i=e.setIsModalVisible,c=$.Z.useForm(),o=(0,a.Z)(c,1)[0],m=(0,P.D)(b.yC,{refetchQueries:[b.H1],onCompleted:function(e){i(!1)}}),k=(0,a.Z)(m,2),g=k[0],f=k[1],p=f.loading,x=f.error,Z=f.called,A=(0,P.D)(b.d3,{refetchQueries:[b.H1],onCompleted:function(e){s.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0445\u0430\u0434\u0433\u0430\u043b\u043b\u0430\u0430"),i(!1)}}),C=(0,a.Z)(A,2),B=C[0],T=C[1].loading;return(0,r.useEffect)((function(){"edit"===n?o.setFieldsValue(t):"create"===n&&o.resetFields(),!0===Z&&s.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0445\u0430\u0434\u0433\u0430\u043b\u043b\u0430\u0430")}),[Z,t,o,n]),x&&s.ZP.error("".concat(x.message)),(0,v.jsx)(u.Z,{spinning:p||T,tip:"\u0410\u0447\u0430\u0430\u043b\u043b\u0430\u0436 \u0431\u0430\u0439\u043d\u0430...",children:(0,v.jsx)($.Z,{id:"MarkPercentageForm",layout:"vertical",form:o,name:"control-hooks",onFinish:function(e){"edit"===n?(e.id=t.id,B({variables:e})):e.fields.map((function(e){for(var n=e.minPercentage,t=e.maxPercentage;n<=t;n++){var r={diam:e.diam,type:e.type,percentage:n};g({variables:r})}return null}))},children:"create"===n?(0,v.jsx)($.Z.List,{name:"fields",children:function(e,n){var t=n.add,r=n.remove;return(0,v.jsxs)(h.Z,{gutter:[16,16],children:[e.map((function(n,t){return(0,v.jsxs)(j.Z,{span:8,children:[(0,v.jsx)($.Z.Item,{name:[t,"type"],label:"\u04ae\u043d\u044d\u043b\u0433\u044d\u044d",rules:[{required:!0,message:"\u0425\u043e\u043e\u0441\u043e\u043d \u043e\u0440\u0445\u0438\u0445 \u0431\u043e\u043b\u043e\u043c\u0436\u0433\u04af\u0439"}],children:(0,v.jsx)(l.Z,{placeholder:"\u04ae\u043d\u044d\u043b\u0433\u044d\u044d"})}),(0,v.jsx)($.Z.Item,{label:"\u04ae\u043d\u044d\u043b\u0433\u044d\u044d\u043d\u0438\u0439 \u0434\u044d\u044d\u0434 / \u0434\u043e\u043e\u0434 \u0445\u0443\u0432\u044c",children:(0,v.jsxs)(l.Z.Group,{compact:!0,children:[(0,v.jsx)($.Z.Item,{name:[t,"maxPercentage"],noStyle:!0,rules:[{required:!0,message:"\u0425\u043e\u043e\u0441\u043e\u043d \u043e\u0440\u0445\u0438\u0445 \u0431\u043e\u043b\u043e\u043c\u0436\u0433\u04af\u0439"},function(){return{validator:function(e,n){return(null===n||void 0===n?void 0:n.length)>3||n>100?Promise.reject("100-\u0430\u0430\u0441 \u0434\u044d\u044d\u0448 \u0442\u043e\u043e \u043e\u0440\u0443\u0443\u043b\u0430\u0445 \u0431\u043e\u043b\u043e\u043c\u0436\u0433\u04af\u0439"):Promise.resolve()}}}],children:(0,v.jsx)(y.Z,{min:1,placeholder:"\u0414\u044d\u044d\u0434 \u0445\u0443\u0432\u044c"})}),(0,v.jsx)($.Z.Item,{name:[t,"minPercentage"],noStyle:!0,rules:[{required:!0,message:"\u0425\u043e\u043e\u0441\u043e\u043d \u043e\u0440\u0445\u0438\u0445 \u0431\u043e\u043b\u043e\u043c\u0436\u0433\u04af\u0439"},function(){return{validator:function(e,n){return(null===n||void 0===n?void 0:n.length)>3||n>100?Promise.reject("100-\u0430\u0430\u0441 \u0434\u044d\u044d\u0448 \u0442\u043e\u043e \u043e\u0440\u0443\u0443\u043b\u0430\u0445 \u0431\u043e\u043b\u043e\u043c\u0436\u0433\u04af\u0439"):Promise.resolve()}}}],children:(0,v.jsx)(y.Z,{style:{marginLeft:"10px"},min:0,placeholder:"\u0414\u043e\u043e\u0434 \u0445\u0443\u0432\u044c"})})]})}),(0,v.jsx)($.Z.Item,{name:[t,"diam"],label:"\u04ae\u043d\u044d\u043b\u0433\u044d\u044d\u043d\u0438\u0439 \u0433\u043e\u043b\u0447",rules:[{required:!0,message:"\u0425\u043e\u043e\u0441\u043e\u043d \u043e\u0440\u0445\u0438\u0445 \u0431\u043e\u043b\u043e\u043c\u0436\u0433\u04af\u0439"}],children:(0,v.jsx)(l.Z,{placeholder:"\u04ae\u043d\u044d\u043b\u0433\u044d\u044d\u043d\u0438\u0439 \u0433\u043e\u043b\u0447"})}),e.length>1?(0,v.jsx)(d.Z,{type:"primary",danger:!0,onClick:function(){return r(n.name)},icon:(0,v.jsx)(I.Z,{}),children:"\u0423\u0441\u0442\u0433\u0430\u0445"}):null]},n.key)})),(0,v.jsx)($.Z.Item,{children:(0,v.jsxs)(d.Z,{type:"dashed",onClick:function(){return t()},style:{width:"100%",margin:"29px"},children:[(0,v.jsx)(S.Z,{})," ",(0,v.jsx)(M.Z,{id:"add-field"})]})})]})}}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)($.Z.Item,{name:"type",label:"\u04ae\u043d\u044d\u043b\u0433\u044d\u044d",rules:[{required:!0,message:"\u0425\u043e\u043e\u0441\u043e\u043d \u043e\u0440\u0445\u0438\u0445 \u0431\u043e\u043b\u043e\u043c\u0436\u0433\u04af\u0439"}],children:(0,v.jsx)(l.Z,{placeholder:"\u04ae\u043d\u044d\u043b\u0433\u044d\u044d"})}),(0,v.jsx)($.Z.Item,{name:"percentage",label:"\u04ae\u043d\u044d\u043b\u0433\u044d\u044d\u043d\u0438\u0439 \u0434\u044d\u044d\u0434 / \u0434\u043e\u043e\u0434 \u0445\u0443\u0432\u044c",children:(0,v.jsx)(y.Z,{style:{width:"100%"},min:0,placeholder:"\u0414\u043e\u043e\u0434 \u0445\u0443\u0432\u044c"})}),(0,v.jsx)($.Z.Item,{name:"diam",label:"\u04ae\u043d\u044d\u043b\u0433\u044d\u044d\u043d\u0438\u0439 \u0433\u043e\u043b\u0447",rules:[{required:!0,message:"\u0425\u043e\u043e\u0441\u043e\u043d \u043e\u0440\u0445\u0438\u0445 \u0431\u043e\u043b\u043e\u043c\u0436\u0433\u04af\u0439"}],children:(0,v.jsx)(l.Z,{placeholder:"\u04ae\u043d\u044d\u043b\u0433\u044d\u044d\u043d\u0438\u0439 \u0433\u043e\u043b\u0447"})})]})})})},C=t(96578);var B=function(e){var n=(0,C.a)(b.H1,{}),t=n.loading,$=n.data,h=(0,r.useState)(void 0),j=(0,a.Z)(h,2),y=j[0],I=j[1];(0,r.useEffect)((function(){!1===t&&$&&I($.allMarkPercentages)}),[t,$]);var S=(0,r.useState)(!1),B=(0,a.Z)(S,2),T=B[0],F=B[1],w=(0,r.useState)([]),D=(0,a.Z)(w,2),N=D[0],q=D[1],_=(0,r.useState)(""),V=(0,a.Z)(_,2),R=V[0],H=V[1],z=i.Z.confirm,L=(0,P.D)(b._W,{refetchQueries:[b.H1],onCompleted:function(e){s.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0443\u0441\u0442\u043b\u0430\u0430")}}),O=(0,a.Z)(L,2),Q=O[0],E=O[1].loading,W=[{key:"type",title:(0,v.jsx)(M.Z,{id:"mark.type"}),dataIndex:"type",sorter:function(e,n){return Z.ZP.antdTableSorter(e,n,"type")}},{key:"percentage",title:(0,v.jsx)(M.Z,{id:"mark.percentage"}),dataIndex:"percentage",sorter:function(e,n){return Z.ZP.antdTableSorter(e,n,"percentage")}},{key:"diam",title:(0,v.jsx)(M.Z,{id:"mark.diam"}),dataIndex:"diam",sorter:function(e,n){return Z.ZP.antdTableSorter(e,n,"diam")}},{key:"actions",title:(0,v.jsx)(M.Z,{id:"main.action"}),width:"20vw",dataIndex:"actions",render:function(n,t){return(0,v.jsxs)("div",{className:"text-center",children:[!0===e.permissions.edit&&(0,v.jsx)(d.Z,{size:"small",type:"text",onClick:function(){return function(e){H("edit"),q(e),F(!0)}(t)},children:(0,v.jsxs)(x.Z,{alignItems:"center",children:[(0,v.jsx)(k.Z,{twoToneColor:"#ffdb00"}),(0,v.jsxs)("span",{className:"ml-2",children:[" ",(0,v.jsx)(M.Z,{id:"edit"})]})]})},"2"),!0===e.permissions.destroy&&(0,v.jsx)(d.Z,{size:"small",type:"text",onClick:function(){return function(e){z({title:"\u0423\u0441\u0442\u0433\u0430\u0445 \u0443\u0443?",okText:"\u0423\u0441\u0442\u0433\u0430\u0445",okType:"danger",cancelText:"\u0411\u043e\u043b\u0438\u0445",onOk:function(){Q({variables:{id:e.id}})}})}(t)},children:(0,v.jsxs)(x.Z,{alignItems:"center",children:[(0,v.jsx)(g.Z,{twoToneColor:"#f42f2f"}),(0,v.jsxs)("span",{className:"ml-2",children:[" ",(0,v.jsx)(M.Z,{id:"delete"})]})]})},"3")]})}}];return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(i.Z,{visible:T,okText:(0,v.jsx)(M.Z,{id:"main.okText"}),cancelText:(0,v.jsx)(M.Z,{id:"main.cancelText"}),width:"80vw",onCancel:function(){F(!1)},okButtonProps:{form:"MarkPercentageForm",key:"submit",htmlType:"submit"},children:(0,v.jsx)(A,{editData:N,formType:R,setIsModalVisible:F})}),(0,v.jsxs)(c.Z,{children:[(0,v.jsxs)(x.Z,{alignItems:"center",justifyContent:"between",mobileFlex:!1,children:[(0,v.jsx)(x.Z,{className:"mb-1",mobileFlex:!1,children:(0,v.jsx)("div",{className:"mr-md-3 mb-3",children:(0,v.jsx)(l.Z,{placeholder:"\u0425\u0430\u0439\u0445",prefix:(0,v.jsx)(f.Z,{}),onChange:function(e){return function(e){var n=e.currentTarget.value,t=e.currentTarget.value?y:$.allMarkPercentages,r=Z.ZP.wildCardSearch(t,n);I(r)}(e)}})})}),!0===e.permissions.create&&(0,v.jsx)("div",{className:"mr-md-3 mb-3",children:(0,v.jsxs)(d.Z,{onClick:function(){H("create"),F(!0)},type:"primary",icon:(0,v.jsx)(p.Z,{}),block:!0,children:[" ",(0,v.jsx)(M.Z,{id:"add_new"})]})})]}),(0,v.jsx)("div",{className:"table-responsive",children:(0,v.jsx)(o.Z,{columns:W,dataSource:y,size:"small",rowKey:"id",bordered:!0,locale:{emptyText:t||E?(0,v.jsx)(u.Z,{}):(0,v.jsx)(m.Z,{})}})})]})]})},T=t(59288),F=t(38937),w=function(){var e={create:(0,T.C)("add_mark_percentage"),edit:(0,T.C)("change_mark_percentage"),destroy:(0,T.C)("delete_mark_percentage")};return Object.values(e).indexOf("loading")>-1?(0,v.jsx)(F.Z,{cover:"content"}):(0,v.jsx)(B,{permissions:e})}}}]);
//# sourceMappingURL=3240.8f83c404.chunk.js.map