"use strict";(self.webpackChunkemind=self.webpackChunkemind||[]).push([[6158],{68470:function(n,e,t){t(72791);var a=t(80184),r=function(n){var e=n.children,t=n.className,r=n.alignItems,i=n.justifyContent,s=n.mobileFlex,o=n.flexDirection;return(0,a.jsx)("div",{className:"".concat(s?"d-flex":"d-md-flex"," ").concat(t," ").concat(o?"flex-"+o:""," ").concat(r?"align-items-"+r:""," ").concat(i?"justify-content-"+i:""),children:e})};r.defaultProps={mobileFlex:!0,flexDirection:"row",className:""},e.Z=r},42086:function(n,e,t){var a=t(29439),r=t(72791),i=t(96578),s=t(86586),o=t(22949),l=t(73332),d=t(58361),c=t(66106),u=t(30914),m=t(66871),f=t(69421),g=t(87309),k=t(82630),$=t(68694),p=t(38937),Z=t(80184),h=o.Z.Option;e.Z=function(n){var e=n.submitData,t=n.mutationData,x=n.loading,y=l.Z.useForm(),j=(0,a.Z)(y,1)[0],S=l.Z.useForm(),P=(0,a.Z)(S,1)[0],b=(0,r.useState)([]),v=(0,a.Z)(b,2),C=v[0],I=v[1],M=(0,r.useState)([]),B=(0,a.Z)(M,2),N=B[0],A=B[1],q=(0,r.useState)([]),D=(0,a.Z)(q,2),F=D[0],w=D[1],V=(0,i.a)($.dT,{onCompleted:function(n){I(n.allPrograms)}}).loading,T=(0,s.t)($.tL,{onCompleted:function(n){A(n.sectionsByProgram)}}),R=(0,a.Z)(T,2),E=R[0],O=R[1].loading,_=(0,s.t)($.JX,{onCompleted:function(n){w(n.allStudents)}}),L=(0,a.Z)(_,2),z=L[0],X=L[1].loading,J=function(n){n.hasOwnProperty("studentCode")?n.section=0:n.studentCode="";var a=Object.assign(n,t);e({variables:a})};return(0,Z.jsx)(d.Z,{active:!0,loading:V,children:(0,Z.jsxs)(c.Z,{gutter:16,children:[(0,Z.jsx)(u.Z,{xs:24,xl:12,children:(0,Z.jsx)(m.Z,{className:"mt-4",title:(0,Z.jsx)(k.Z,{id:"by-section"}),children:(0,Z.jsxs)(l.Z,{id:"section",layout:"vertical",form:j,name:"control-hooks",onFinish:J,children:[(0,Z.jsx)(l.Z.Item,{name:"program",label:(0,Z.jsx)(k.Z,{id:"program"}),rules:[{required:!0,message:(0,Z.jsx)(k.Z,{id:"form.required"})}],children:(0,Z.jsx)(o.Z,{onSelect:function(n){j.setFieldsValue({section:""}),E({variables:{program:n}})},allowClear:!0,showSearch:!0,optionFilterProp:"children",filterOption:function(n,e){return e.children.toString().toLowerCase().indexOf(n.toLowerCase())>=0},children:C.map((function(n,e){return(0,Z.jsxs)(h,{value:n.id,children:[n.program," / ",n.programNumeric]},e)}))})}),(0,Z.jsx)(l.Z.Item,{name:"section",label:(0,Z.jsx)(k.Z,{id:"section"}),rules:[{required:!0,message:(0,Z.jsx)(k.Z,{id:"form.required"})}],children:(0,Z.jsx)(o.Z,{allowClear:!0,notFoundContent:O?(0,Z.jsx)(p.Z,{cover:"content"}):(0,Z.jsx)(f.Z,{image:f.Z.PRESENTED_IMAGE_SIMPLE}),children:N.map((function(n,e){return(0,Z.jsxs)(h,{value:n.id,children:[n.classes.classes," / ",n.section]},e)}))})}),(0,Z.jsx)(l.Z.Item,{className:"text-right",children:(0,Z.jsx)(g.Z,{className:"mr-2",type:"primary",htmlType:"submit",loading:x,children:(0,Z.jsx)(k.Z,{id:"main.okText"})})})]})})}),(0,Z.jsx)(u.Z,{xs:24,xl:12,children:(0,Z.jsx)(m.Z,{className:"mt-4",title:(0,Z.jsx)(k.Z,{id:"by-student-code"}),children:(0,Z.jsxs)(l.Z,{id:"student",layout:"vertical",form:P,name:"control-hooks",onFinish:J,children:[(0,Z.jsx)(l.Z.Item,{name:"studentCode",label:(0,Z.jsx)(k.Z,{id:"studentCode"}),rules:[{required:!0,message:(0,Z.jsx)(k.Z,{id:"form.required"})}],children:(0,Z.jsx)(o.Z,{showSearch:!0,filterOption:!1,notFoundContent:X?(0,Z.jsx)(p.Z,{cover:"content"}):(0,Z.jsx)(f.Z,{image:f.Z.PRESENTED_IMAGE_SIMPLE}),onSearch:function(n){""===n?w([]):z({variables:{offset:0,limit:99999999,filter:n}})},children:F.map((function(n,e){return(0,Z.jsxs)(h,{value:n.studentCode,children:[" ",n.familyName," ",n.name," / ",n.studentCode]},e)}))})}),(0,Z.jsx)(l.Z.Item,{className:"text-right",children:(0,Z.jsx)(g.Z,{className:"mr-2",type:"primary",htmlType:"submit",loading:x,children:(0,Z.jsx)(k.Z,{id:"main.okText"})})})]})})})]})})}},68120:function(n,e,t){t.d(e,{$h:function(){return w},H1:function(){return I},L8:function(){return P},S8:function(){return T},Xc:function(){return A},_W:function(){return N},d3:function(){return B},d6:function(){return q},ey:function(){return V},fJ:function(){return b},iF:function(){return F},kk:function(){return C},sF:function(){return R},ux:function(){return D},yC:function(){return M},zX:function(){return v}});var a,r,i,s,o,l,d,c,u,m,f,g,k,$,p,Z,h,x,y,j=t(30168),S=t(27570),P=(0,S.Ps)(a||(a=(0,j.Z)(["\n    query allMarks ($markBoard: Int!) {\n        allMarks (markBoard: $markBoard) {\n            id\n            student {\n                id\n                familyName\n                name\n                studentCode\n            }\n            markRelSet {\n                markVal\n                markSetting {\n                    id\n                    name\n                }\n            }\n            markBoard {\n                subject {\n                    subject\n                }\n            }\n        }\n    }\n"]))),b=(0,S.Ps)(r||(r=(0,j.Z)(["\n    mutation createMark ($section: Int, $studentCode: String, $markBoard: Int) {\n        createMark (section: $section, studentCode: $studentCode, markBoard: $markBoard) {\n            mark {\n                id\n            }\n        }\n    }\n"]))),v=(0,S.Ps)(i||(i=(0,j.Z)(["\n    mutation deleteMark ($id: ID) {\n        deleteMark (id: $id) {\n            mark {\n                student {\n                    id\n                }\n            }\n        }\n    }\n"]))),C=(0,S.Ps)(s||(s=(0,j.Z)(["\n    mutation createMarkRel ($mark: Int, $markSetting: Int, $markVal: String) {\n        createMarkRel (mark: $mark, markSetting: $markSetting, markVal: $markVal) {\n            markRel {\n                id\n                markVal\n                markSetting {\n                    id\n                    name\n                }\n            }\n        }\n    }\n"]))),I=((0,S.Ps)(o||(o=(0,j.Z)(["\n    query allMarkRels ($mark: Int!) {\n        allMarkRels (mark: $mark) {\n            mark {\n                student {\n                    id\n                    studentCode\n                }\n            }\n            markSetting {\n                name\n                percentage\n            }\n            markVal\n        }\n    }\n"]))),(0,S.Ps)(l||(l=(0,j.Z)(["\n    query allMarkPercentages {\n        allMarkPercentages {\n            id\n            type\n            percentage\n            diam\n        }\n    }\n"])))),M=(0,S.Ps)(d||(d=(0,j.Z)(["\n    mutation createMarkPercentage ($diam: String, $percentage: Int, $type: String) {\n        createMarkPercentage (diam: $diam, percentage: $percentage, type: $type) {\n            markPercentage {\n                type\n            }\n        }\n    }\n"]))),B=(0,S.Ps)(c||(c=(0,j.Z)(["\n    mutation updateMarkPercentage ($diam: String, $percentage: Int, $type: String, $id: ID) {\n        updateMarkPercentage (diam: $diam, percentage: $percentage, type: $type, id: $id) {\n            markPercentage {\n                type\n            }\n        }\n    }\n"]))),N=(0,S.Ps)(u||(u=(0,j.Z)(["\n    mutation deleteMarkPercentage ($id: ID) {\n        deleteMarkPercentage (id: $id) {\n            markPercentage {\n                type\n            }\n        }\n    }\n"]))),A=((0,S.Ps)(m||(m=(0,j.Z)(["\n    query markBoardById ($id: Int!) {\n        markBoardById (id: $id) {\n            id\n            schoolyear {\n                id\n                schoolyear\n            }\n            subject {\n                id\n                subject\n            }\n            teacher {\n                id\n                name\n            }\n            startAt \n            endAt\n            status\n            createdAt\n            updatedAt\n        }\n    }\n"]))),(0,S.Ps)(f||(f=(0,j.Z)(['\n    query allMarkBoards ($offset: Int!, $limit: Int!, $filter: String) {\n        count (appName: "mark", modelName: "Mark_board", filter: $filter) {\n            count\n        }\n        allMarkBoards (offset: $offset, limit: $limit, filter: $filter) {\n            id\n            schoolyear {\n                id\n                schoolyear\n            }\n            subject {\n                id\n                subject\n            }\n            teacher {\n                id\n                name\n            }\n            startAt \n            endAt\n            status\n            createdAt\n            updatedAt\n        }\n    }\n'])))),q=((0,S.Ps)(g||(g=(0,j.Z)(["\n    mutation createMarkBoardFromRoutine ($endAt: String, $routine: Int, $startAt: String, $status: String) {\n        createMarkBoardFromRoutine (endAt: $endAt, routine: $routine, startAt: $startAt, status: $status) {\n            markBoard {\n                id\n            }\n        }\n    }\n"]))),(0,S.Ps)(k||(k=(0,j.Z)(["\n    mutation createMarkBoard ($endAt: String, $schoolyear: Int, $startAt: String, $status: String, $subject: Int, $teacher: Int) {\n        createMarkBoard (endAt: $endAt, schoolyear: $schoolyear, startAt: $startAt, status: $status, subject: $subject, teacher: $teacher) {\n            markBoard {\n                id\n            }\n        }\n    }\n"])))),D=(0,S.Ps)($||($=(0,j.Z)(["\n    mutation updateMarkBoard ($endAt: String, $schoolyear: Int, $startAt: String, $status: String, $subject: Int, $teacher: Int, $id: ID) {\n        updateMarkBoard (endAt: $endAt, schoolyear: $schoolyear, startAt: $startAt, status: $status, subject: $subject, teacher: $teacher, id: $id) {\n            markBoard {\n                id\n            }\n        }\n    }\n"]))),F=(0,S.Ps)(p||(p=(0,j.Z)(["\n    mutation deleteMarkBoard ($id: ID) {\n        deleteMarkBoard (id: $id) {\n            markBoard {\n                startAt\n            }\n        }\n    }\n"]))),w=(0,S.Ps)(Z||(Z=(0,j.Z)(["\n    query allMarkSettings {\n        allMarkSettings {\n            id\n            name\n            percentage\n            createdAt\n            updatedAt\n        }\n    }\n"]))),V=(0,S.Ps)(h||(h=(0,j.Z)(["\n    mutation createMarkSetting ($name: String, $percentage: Int) {\n        createMarkSetting (name: $name, percentage: $percentage) {\n            markSetting {\n                id\n            }\n        }\n    }\n"]))),T=(0,S.Ps)(x||(x=(0,j.Z)(["\n    mutation updateMarkSetting ($name: String, $percentage: Int, $id: ID) {\n        updateMarkSetting (name: $name, percentage: $percentage, id: $id) {\n            markSetting {\n                id\n            }\n        }\n    }\n"]))),R=(0,S.Ps)(y||(y=(0,j.Z)(["\n    mutation deleteMarkSetting($id: ID) {\n        deleteMarkSetting (id: $id) {\n            markSetting {\n                name\n            }\n        }\n    }\n"])))},68694:function(n,e,t){t.d(e,{Cm:function(){return $},Cx:function(){return g},FQ:function(){return k},JX:function(){return f},Z2:function(){return x},dT:function(){return p},gt:function(){return h},tL:function(){return Z}});var a,r,i,s,o,l,d,c,u=t(30168),m=t(27570),f=(0,m.Ps)(a||(a=(0,u.Z)(["\n    query allStudents ($filter: String) {\n        allStudents (filter: $filter) {\n            id\n            familyName\n            name\n            studentCode\n        }\n\t}\n"]))),g=(0,m.Ps)(r||(r=(0,u.Z)(["\n    query allTeachers ($filter: String) {\n        allTeachers (filter: $filter) {\n            id\n            familyName\n            name\n            teacherCode\n        }\n    }\n"]))),k=(0,m.Ps)(i||(i=(0,u.Z)(["\n    query allClassess ($filter: String, $program: Int) {\n        allClassess (filter: $filter, program: $program) {\n            id\n            classes\n        }\n\t}\n"]))),$=(0,m.Ps)(s||(s=(0,u.Z)(['\n    query allSubjects ($offset: Int!, $limit: Int!, $filter: String) {\n        count (appName: "subject", modelName: "Subject", filter: $filter) {\n            count\n        }\n        allSubjects (offset: $offset, limit: $limit, filter: $filter) {\n            id\n            subject\n            content\n            createUserid {\n                firstName\n                lastName\n            }\n        }\n    }\n']))),p=(0,m.Ps)(o||(o=(0,u.Z)(["\n    query selectProgram {\n        allPrograms {\n            id\n            program\n        }\n    }\n"]))),Z=(0,m.Ps)(l||(l=(0,u.Z)(["\n    query sectionsByProgram ($program: Int!) {\n        sectionsByProgram (program: $program) {\n            id\n            section \n            classes {\n                classes\n            }\n        }\n    }\n"]))),h=(0,m.Ps)(d||(d=(0,u.Z)(["\n    query sectionsByClasses ($classes: Int!){\n        sectionsByClasses (classes: $classes) {\n            id \n            section\n        }\n    }\n"]))),x=(0,m.Ps)(c||(c=(0,u.Z)(['\n    query allStudentsPagination (\n        $page: Int\n        $perPage: Int\n        $filter: String = ""\n    ) {\n        allStudentsPagination (\n            page: $page\n            perPage: $perPage\n            filter: $filter\n        ) {\n            page\n            perPage\n            pageCount\n            totalCount\n            records {\n                id\n                name\n                familyName\n            }\n        }\n    }\n'])))},86158:function(n,e,t){t.r(e),t.d(e,{default:function(){return C}});var a=t(29439),r=t(72791),i=t(4942),s=t(20003),o=t(50419),l=t(76835),d=t(87309),c=t(66871),u=t(37083),m=t(59432),f=t(82464),g=t(53834),k=t(68470),$=t(96578),p=t(84376),Z=t(68120),h=t(82630),x=t(64880),y=t(42086),j=t(80184),S=s.Z.confirm;var P=function(n){var e=(0,x.k6)(),t=(0,$.a)(Z.L8,{variables:{markBoard:n.markBoard.id},fetchPolicy:"network-only",onCompleted:function(n){var e=[];null===s||void 0===s||s.allMarks.map((function(n){var t={};return n.markRelSet.map((function(n){var e=n.markSetting.name;return Object.assign(t,(0,i.Z)({},e,{markVal:n.markVal,settingName:n.markSetting.name,settingID:n.markSetting.id}))})),e.push({relData:t,student:n.student.id,name:n.student.name,familyName:n.student.familyName,studentCode:n.student.studentCode,mark:n.id,key:n.student.id})})),w(e)}}),s=t.data,P=t.loading,b=t.refetch,v=(0,p.D)(Z.kk,{onCompleted:function(n){o.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0445\u0430\u0434\u0433\u0430\u043b\u043b\u0430\u0430")}}),C=(0,a.Z)(v,2),I=C[0],M=C[1].loading,B=(0,p.D)(Z.zX,{onCompleted:function(n){b()}}),N=(0,a.Z)(B,1)[0],A=(0,$.a)(Z.$h).data,q=(0,r.useState)(void 0),D=(0,a.Z)(q,2),F=D[0],w=D[1],V=[{key:"familyName",title:(0,j.jsx)(h.Z,{id:"familyName"}),dataIndex:"familyName"},{key:"name",title:(0,j.jsx)(h.Z,{id:"name"}),dataIndex:"name"},{key:"studentCode",title:(0,j.jsx)(h.Z,{id:"studentCode"}),dataIndex:"studentCode"}],T=[];null===A||void 0===A||A.allMarkSettings.map((function(n,e){return V.push({key:n.name,title:n.name,dataIndex:["relData","".concat(n.name),"markVal"],render:function(e,t,a){return(0,j.jsx)("div",{children:(0,j.jsx)(l.Z,{defaultValue:e,max:n.percentage,min:0,onChange:function(e){return function(n,e,t,a){T.length?0===T.filter((function(n){return n.mark===a.mark&&n.markSetting===e})).length?T.push({mark:a.mark,markSetting:e,markVal:n}):T.filter((function(n){return n.mark===a.mark&&n.markSetting===e})).map((function(e){return e.markVal=n})):T.push({mark:a.mark,markSetting:e,markVal:n})}(e,n.id,0,t)}})})}})})),V.push({key:"delete",title:"\u0425\u0430\u0441\u0430\u0445",render:function(n,e){return(0,j.jsx)(d.Z,{size:"small",onClick:function(){return n=e.mark,void S({title:"\u0425\u0430\u0441\u0430\u0445 \u0443\u0443?",okText:"\u0425\u0430\u0441\u0430\u0445",okType:"danger",cancelText:"\u0411\u043e\u043b\u0438\u0445",onOk:function(){N({variables:{id:n}})}});var n},type:"text",icon:(0,j.jsx)(f.Z,{twoToneColor:"#f42f2f"}),children:" \u0425\u0430\u0441\u0430\u0445 "})}});var R=(0,p.D)(Z.fJ,{onError:function(n){"Student matching query does not exist."===n.message&&o.ZP.warning("\u0421\u0443\u0440\u0430\u043b\u0446\u0430\u0433\u0447 \u043e\u043b\u0434\u0441\u043e\u043d\u0433\u04af\u0439!")},onCompleted:function(n){o.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0445\u0430\u0434\u0433\u0430\u043b\u043b\u0430\u0430"),b()}}),E=(0,a.Z)(R,2),O=E[0],_=E[1].loading;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(k.Z,{alignItems:"center",justifyContent:"between",mobileFlex:!1,children:(0,j.jsx)(k.Z,{mobileFlex:!1,children:(0,j.jsx)("div",{className:"text-right",children:(0,j.jsxs)(d.Z,{onClick:function(){return e.goBack()},type:"default",icon:(0,j.jsx)(g.Z,{}),block:!0,children:[" ",(0,j.jsx)(h.Z,{id:"back"})]})})})}),(0,j.jsx)(y.Z,{submitData:O,loading:_,mutationData:{markBoard:n.markBoard.id}}),void 0!==F?(0,j.jsx)(c.Z,{className:"mt-4",children:(0,j.jsx)("div",{className:"table-responsive",children:(0,j.jsxs)(u.Z,{spinning:P,children:[(0,j.jsx)(m.Z,{columns:V,dataSource:F,rowKey:"key",size:"small",pagination:!1,bordered:!0,loading:P}),(0,j.jsxs)(k.Z,{alignItems:"left",justifyContent:"between",mobileFlex:!1,children:[(0,j.jsx)(k.Z,{className:"mb-1",mobileFlex:!1}),!0===n.permissions.create&&(0,j.jsx)(d.Z,{style:{margin:"10px"},onClick:function(){0===T.length?o.ZP.warning("\u04e8\u04e9\u0440\u0447\u043b\u04e9\u043b\u0442 \u0430\u043b\u0433\u0430 \u0431\u0430\u0439\u043d\u0430"):null===T||void 0===T||T.filter((function(n){return null!==n.markVal})).map((function(n,e){return I({variables:n})}))},type:"primary",loading:M,children:(0,j.jsx)(h.Z,{id:"main.okText"})})]})]})})}):null]})},b=t(59288),v=t(38937),C=function(n){var e,t=(0,x.k6)(),i=(0,b.C)("add_mark"),s=(0,b.C)("change_mark"),o=(0,b.C)("delete_mark"),l=(0,r.useState)(null===(e=n.location.state)||void 0===e?void 0:e.markBoard),d=(0,a.Z)(l,1)[0],c={create:i,edit:s,destroy:o};return Object.values(c).indexOf("loading")>-1?(0,j.jsx)(v.Z,{cover:"content"}):void 0===n.location.state?(t.push("/app/home"),null):(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(P,{title:n.title,permissions:c,markBoard:d})})}},53834:function(n,e,t){t.d(e,{Z:function(){return l}});var a=t(1413),r=t(72791),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M793 242H366v-74c0-6.7-7.7-10.4-12.9-6.3l-142 112a8 8 0 000 12.6l142 112c5.2 4.1 12.9.4 12.9-6.3v-74h415v470H175c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h618c35.3 0 64-28.7 64-64V306c0-35.3-28.7-64-64-64z"}}]},name:"rollback",theme:"outlined"},s=t(8711),o=function(n,e){return r.createElement(s.Z,(0,a.Z)((0,a.Z)({},n),{},{ref:e,icon:i}))};o.displayName="RollbackOutlined";var l=r.forwardRef(o)}}]);
//# sourceMappingURL=6158.9e3730ee.chunk.js.map