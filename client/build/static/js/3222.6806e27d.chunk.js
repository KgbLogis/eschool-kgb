"use strict";(self.webpackChunkemind=self.webpackChunkemind||[]).push([[3222],{21708:function(e,n,t){t.d(n,{FP:function(){return l},Pg:function(){return d},fc:function(){return p},l7:function(){return f},rT:function(){return v}});var i,r,o,a,u,c=t(30168),s=t(27570),d=(0,s.Ps)(i||(i=(0,c.Z)(['\n    query allLives ($offset: Int!, $limit: Int!, $filter: String) {\n        count (appName: "live", modelName: "Live", filter: $filter) {\n            count\n        }\n        allLives (offset: $offset, limit: $limit, filter: $filter) {\n            id\n            title\n            date\n            duration\n            description\n            status\n            type\n            section {\n                id\n                section\n            }\n            password\n            teacher {\n                id\n                name\n            }\n            password\n        }\n    }\n']))),l=(0,s.Ps)(r||(r=(0,c.Z)(["\n    mutation createLive ($date: DateTime, $description: String, $duration: Int, $status: String, $teacher: Int, $title: String, $section: Int) {\n        createLive (date: $date, description: $description, duration: $duration, status: $status, teacher: $teacher, title: $title, section: $section) {\n            live {\n                id\n            }\n        }\n    }\n"]))),f=(0,s.Ps)(o||(o=(0,c.Z)(["\n    mutation updateLive ($date: DateTime, $description: String, $duration: Int, $id: ID, $status: String, $teacher: Int, $title: String, $section: Int) {\n        updateLive (date: $date, description: $description, duration: $duration, id: $id, status: $status, teacher: $teacher, title: $title, section: $section) {\n            live {\n                id\n            }\n        }\n    }\n"]))),v=(0,s.Ps)(a||(a=(0,c.Z)(["\n    mutation deleteLive ($id: ID) {\n        deleteLive (id: $id) {\n            live {\n                title\n            }\n        }\n    }\n"]))),p=(0,s.Ps)(u||(u=(0,c.Z)(["\n    query getLiveurl ($liveId: Int) {\n        getLiveurl (liveId: $liveId) {\n            url\n            password\n        }\n    }\n"])))},53222:function(e,n,t){t.r(n),t.d(n,{default:function(){return I}});var i,r=t(29439),o=t(72791),a=t(96578),u=t(21708),c=t(64880),s=t(80184),d="meet.jit.si",l=t(74165),f=function(e,n,t,i){return new(t||(t=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(n){o(n)}}function u(e){try{c(i.throw(e))}catch(n){o(n)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,u)}c((i=i.apply(e,n||[])).next())}))},v=function(e,n,t){return f(void 0,void 0,void 0,(0,l.Z)().mark((function i(){return(0,l.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new Promise((function(i,r){if(window.JitsiMeetExternalAPI)return i(window.JitsiMeetExternalAPI);var o=document.createElement("script"),a=n?"?release=".concat(n):"",u=t?"".concat(t,"/"):"";o.async=!0,o.src="https://".concat(e,"/").concat(u,"external_api.js").concat(a),o.onload=function(){return i(window.JitsiMeetExternalAPI)},o.onerror=function(){return r(new Error("Script load error: ".concat(o.src)))},document.head.appendChild(o)})));case 1:case"end":return i.stop()}}),i)})))},p=0,m=function(e){return"".concat(e,"-").concat(p++)},$=function(e){var n=e.domain,t=void 0===n?d:n,a=e.roomName,u=e.configOverwrite,c=e.interfaceConfigOverwrite,l=e.jwt,f=e.invitees,p=e.devices,$=e.userInfo,h=e.release,g=e.lang,w=e.spinner,I=e.onApiReady,y=e.onReadyToClose,x=e.getIFrameRef,C=(0,o.useState)(!0),L=(0,r.Z)(C,2),S=L[0],Z=L[1],P=(0,o.useState)(!1),j=(0,r.Z)(P,2),R=j[0],E=j[1],N=(0,o.useRef)(),k=(0,o.useRef)(),b=(0,o.useRef)(null),T=(0,o.useMemo)((function(){return m("jitsiMeeting")}),[m]);(0,o.useEffect)((function(){(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,n=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0;return i||(i=v(e,n,t))})(t,h,function(e){var n=e.split("/");if(!(n.length<=1))return n[0]}(a)).then((function(e){N.current=e,E(!0)})).catch((function(e){return console.error(e.message)}))}),[]);var A=(0,o.useCallback)((function(e){k.current=new e(t,{roomName:a,configOverwrite:u,interfaceConfigOverwrite:c,jwt:l,invitees:f,devices:p,userInfo:$,release:h,lang:g,parentNode:b.current}),Z(!1),k.current&&("function"===typeof I&&I(k.current),k.current.on("readyToClose",(function(){"function"===typeof y&&y()})),b.current&&"function"===typeof x&&x(b.current))}),[k,b,I,y,x,t,a,u,c,l,f,p,$,h,g]);(0,o.useEffect)((function(){R&&!k.current&&N.current&&A(N.current)}),[R,A]);var F=(0,o.useCallback)((function(){return w?!S||k.current?null:(0,s.jsx)(w,{},void 0):null}),[w,k.current]);return(0,s.jsxs)(s.Fragment,{children:[F(),(0,s.jsx)("div",{id:T,ref:b},T)]},void 0)},h=t(38937),g=t(53719),w=t(59305);function I(e){var n=(0,c.UO)().meetingId,t=(0,c.k6)(),i=(0,o.useState)(""),d=(0,r.Z)(i,2),l=d[0],f=d[1],v=(0,o.useState)(""),p=(0,r.Z)(v,2),m=p[0],I=p[1],y=(0,o.useContext)(g.S).user;return(0,a.a)(u.fc,{variables:{liveId:n},onCompleted:function(e){f(e.getLiveurl.url),I(e.getLiveurl.password)}}).loading?(0,s.jsx)(h.Z,{}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)($,{getIFrameRef:function(e){e.className="h-[85vh] flex items-center shadow my-6 md:my-10 lg:h-[80vh]"},domain:w.oY,roomName:l,spinner:h.Z,userInfo:{displayName:y.firstName},onReadyToClose:function(){t.push("/app/live")},onApiReady:function(e){e.addEventListener("participantRoleChanged",(function(n){"moderator"===n.role&&e.executeCommand("password",m)})),e.addEventListener("passwordRequired",(function(){e.executeCommand("password",m)}))}})})}}}]);
//# sourceMappingURL=3222.6806e27d.chunk.js.map