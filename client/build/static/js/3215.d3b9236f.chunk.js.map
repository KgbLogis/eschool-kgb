{"version":3,"file":"static/js/3215.d3b9236f.chunk.js","mappings":"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","sources":["views/app-views/online-lesson/online-lesson-sub/detail.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Card, Typography, Divider, Badge, Row, Col, Table, Button, Image, Modal } from 'antd';\r\nimport { CalendarTwoTone, RollbackOutlined } from '@ant-design/icons';\r\nimport { useQuery } from '@apollo/client';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport { Document, Page, pdfjs } from \"react-pdf\";\r\nimport { SizeMe } from 'react-sizeme';\r\nimport ReactPlayer from 'react-player/lazy'\r\nimport moment from 'moment';\r\nimport Loading from 'components/shared-components/Loading';\r\nimport { SUB_BY_ID } from 'graphql/lesson';\r\nimport { APP_PREFIX_PATH, BASE_SERVER_URL } from \"configs/AppConfig\";\r\nimport IntlMessage from 'components/util-components/IntlMessage';\r\n\r\nconst { Title, Paragraph } = Typography;\r\npdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`;\r\n\r\n\r\nconst attendance_colums = [\r\n    {\r\n        title: <IntlMessage id=\"studentCode\" />,\r\n        dataIndex: ['student', 'studentCode'],\r\n        key: 'studentCode',\r\n    },\r\n    {\r\n        title: <IntlMessage id=\"familyName\" />,\r\n        dataIndex: ['student', 'familyName'],\r\n        key: 'familyName',\r\n    },\r\n    {\r\n        title: <IntlMessage id=\"name\" />,\r\n        dataIndex: ['student', 'name'],\r\n        key: 'name',\r\n    },\r\n]\r\n\r\nconst checkFileType = (file) => {\r\n    const type = file.split('.').pop()\r\n    switch (type) {\r\n        case 'jpg':\r\n        case 'jpeg':\r\n        case 'webp':\r\n        case 'svg':\r\n        case 'png':\r\n            return `image`;\r\n        case 'mp3':\r\n        case 'm4a':\r\n        case 'flac':\r\n            return `audio`;\r\n        case 'mp4':\r\n            return `video`;\r\n        case `pdf`:\r\n            return `pdf`;\r\n        default:\r\n            return BASE_SERVER_URL + file;\r\n    }\r\n}\r\n\r\nconst Detail = (props) => {\r\n\r\n    const slug = useParams();\r\n\r\n    const [pageNumber, setPageNumber] = useState(1);\r\n    const [numPages, setNumPages] = useState(null);\r\n    const [isModalVisible, setIsModalVisible] = useState(false);\r\n    const [selectedFile, setSelectedFile] = useState();\r\n\r\n    const { data, loading } = useQuery(SUB_BY_ID, {\r\n        variables: { id: slug.subLesson }\r\n    });\r\n\r\n    const showModal = (value) => {\r\n        setIsModalVisible(true);\r\n        setSelectedFile(FilePreview(value))\r\n    };\r\n\r\n    const handleCancel = () => {\r\n        setIsModalVisible(false);\r\n    };\r\n\r\n    const goToPrevPage = () => {\r\n        setPageNumber(pageNumber - 1)\r\n    }\r\n    const goToNextPage = () => {\r\n        setPageNumber(pageNumber + 1)\r\n    }\r\n\r\n    const FilePreview = ({ file }) => {\r\n\r\n        switch (checkFileType(file)) {\r\n            case `audio`:\r\n                return (\r\n                    <ReactPlayer\r\n                        className=\"react-player\"\r\n                        width=\"100%\"\r\n                        height=\"50px\"\r\n                        controls={true}\r\n                        url={BASE_SERVER_URL + file}\r\n                    />\r\n                )\r\n            case `video`:\r\n                return (\r\n                    <ReactPlayer\r\n                        width=\"100%\"\r\n                        height=\"100%\"\r\n                        controls={true}\r\n                        url={BASE_SERVER_URL + file}\r\n                    />\r\n                )\r\n            case 'image':\r\n                return (\r\n                    <Card>\r\n                        <Image className=\"img-fluid items-\" width={200} alt=\"Preview\" src={BASE_SERVER_URL + file} />\r\n                        {/* <Image style={{ maxHeight: '250px' }} preview={false} className=\"img-fluid\" alt=\"Preview\" src={BASE_SERVER_URL+file} /> */}\r\n\r\n                    </Card>\r\n                )\r\n\r\n            case `pdf`:\r\n                return (\r\n                    <div>\r\n                        <Modal\r\n                            forceRender\r\n                            width={'50vw'}\r\n                            visible={isModalVisible}\r\n                            onCancel={handleCancel}\r\n                            footer={[\r\n                                <Button key=\"back\" type='text' disabled={pageNumber === 1 && true} onClick={goToPrevPage}>\r\n                                    <IntlMessage id=\"main.previous\" />\r\n                                </Button>,\r\n                                <Button key=\"next\" type=\"primary\" disabled={pageNumber === numPages && true} onClick={goToNextPage}>\r\n                                    <IntlMessage id=\"main.next\" />\r\n                                </Button>,\r\n                            ]}\r\n                        >\r\n                            <SizeMe\r\n                                monitorHeight\r\n                                refreshRate={128}\r\n                                refreshMode={\"debounce\"}\r\n                                render={({ size }) => (\r\n                                    <Document\r\n                                        file={BASE_SERVER_URL + file}\r\n                                        onLoadSuccess={({ numPages }) => setNumPages(numPages)}\r\n                                        renderTextLayer={false}\r\n                                        loading={<Loading cover=\"content\" />}\r\n                                        renderMode=\"svg\"\r\n                                    >\r\n                                        <Page\r\n                                            className=\"test\"\r\n                                            width={size.width}\r\n                                            pageNumber={pageNumber}\r\n                                            renderTextLayer={false}\r\n                                            renderAnnotationLayer={false}\r\n                                        />\r\n                                    </Document>\r\n                                )}\r\n                            />\r\n                            <p>Нийт {numPages} хуудсаас {pageNumber}-г харуулж байна </p>\r\n                        </Modal>\r\n                        <Button type='primary' onClick={showModal} ><IntlMessage id=\"show-file\" /></Button>\r\n                    </div>\r\n                )\r\n            default:\r\n                return (\r\n                    <div>\r\n                        <Button type='primary' onClick={() => window.open(BASE_SERVER_URL + file, '_blank')} ><IntlMessage id=\"show-file\" /></Button>\r\n                    </div>\r\n                )\r\n        }\r\n\r\n    }\r\n\r\n    if (loading) {\r\n        return <Loading cover=\"content\" />\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div className='w-full'>\r\n                <div className='flex justify-between'>\r\n                    <Link to={`${APP_PREFIX_PATH}/online-lesson/lessons`}>\r\n                        <Button\r\n                            // onClick={() => history.goBack()}\r\n                            size='small'\r\n                            type=\"primary\"\r\n                            icon={<RollbackOutlined />}\r\n                        >\r\n                            {\" \"}<IntlMessage id=\"back\" />\r\n                        </Button>\r\n                    </Link>\r\n                </div>\r\n                <div className={`grid gap-4 ${props.viewAttendance ? 'lg:grid-cols-3' : 'lg:grid-cols-1'} mt-4`}>\r\n                    <div className={`${props.viewAttendance ? 'lg:col-span-2' : 'lg:col-span-1'} bg-white p-6 shadow-md rounded-lg`}>\r\n                        <h1 className=\"text-xl font-bold\">{data.onlineSubById.title}</h1>\r\n                        <div className=\"grid grid-cols-2 gap-4 mt-4\">\r\n                            <div>\r\n                                <h5 className=\"text-sm font-semibold\">\r\n                                    <IntlMessage id=\"added-date\" />\r\n                                </h5>\r\n                                <div className=\"flex items-center\">\r\n                                    <CalendarTwoTone className=\"mr-2\" />\r\n                                    {moment(data.onlineSubById.createdAt).format('MMMM DD')}\r\n                                </div>\r\n                            </div>\r\n                            <div>\r\n                                <h5 className=\"text-sm font-semibold\">\r\n                                    <IntlMessage id=\"onlineType\" />\r\n                                </h5>\r\n                                <div className=\"flex items-center\">\r\n                                    <span className=\"w-4 h-4 bg-cyan-400 rounded-full mr-2\"></span>\r\n                                    <span>{data.onlineSubById.onlineType.name}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <p className=\"mt-4 text-gray-700\">{data.onlineSubById.description}</p>\r\n                        <p>{data.onlineSubById.content}</p>\r\n                        <div>\r\n                            {data.onlineSubById.onlineSubFileSet.map((item, index) => (\r\n                                <FilePreview key={index} file={item.onlineFile.file} />\r\n                            ))}\r\n                        </div>\r\n                        <div className=\"flex flex-row-reverse justify-end -space-x-3 space-x-reverse\">\r\n                            {\r\n                                data.onlineSubById.onlineAttendanceSet.map((item, index) => (\r\n                                    <div className=\"relative flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-full bg-gray-100 text-sm font-bold uppercase text-gray-800 ring ring-white\">\r\n                                        <img\r\n                                            className=\"h-full w-full rounded-full object-cover object-center\"\r\n                                            src={BASE_SERVER_URL + item.student.photo}\r\n                                            alt=\"\"\r\n                                        />\r\n                                    </div>\r\n                                ))\r\n                            }\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    )\r\n\r\n}\r\n\r\nexport default Detail;"],"names":["Typography","pdfjs","props","slug","useParams","useState","pageNumber","setPageNumber","numPages","setNumPages","isModalVisible","setIsModalVisible","setSelectedFile","useQuery","SUB_BY_ID","variables","id","subLesson","data","loading","showModal","value","FilePreview","handleCancel","goToPrevPage","goToNextPage","file","split","pop","BASE_SERVER_URL","checkFileType","className","width","height","controls","url","alt","src","forceRender","visible","onCancel","footer","type","disabled","onClick","SizeMe","monitorHeight","refreshRate","refreshMode","render","size","onLoadSuccess","renderTextLayer","cover","renderMode","renderAnnotationLayer","window","open","to","APP_PREFIX_PATH","icon","viewAttendance","onlineSubById","title","moment","createdAt","format","onlineType","name","description","content","onlineSubFileSet","map","item","index","onlineFile","onlineAttendanceSet","student","photo"],"sourceRoot":""}