"use strict";(self.webpackChunkemind=self.webpackChunkemind||[]).push([[9071],{54410:function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});var r=n(72791),o=n(64880),i=n(96578),c=n(38937),a=n(29439),l=n(20003),s=n(50419),d=n(87309),u=n(66871),f=n(49389),v=n(37083),m=n(59432),h=n(82464),p=n(53834),g=n(11730),b=n(31549),Z=n(68470),x=n(2703),j=n(22949),y=n(73332),w=n(69421),C=n(86586),k=n(84376),N=n(90914),E=n(82630),T=n(68694),S=n(80184),I=j.Z.Option;var M=function(e){var t=e.program,n=e.setIsModalVisible,o=y.Z.useForm(),i=(0,a.Z)(o,1)[0],l=(0,r.useState)([]),d=(0,a.Z)(l,2),u=d[0],f=d[1],m=(0,C.t)(T.Cm,{onCompleted:function(e){f(e.allSubjects)}}),h=(0,a.Z)(m,2),p=h[0],g=h[1].loading,b=(0,k.D)(N.yt,{refetchQueries:[{query:N.x5,variables:{id:t}}],onCompleted:function(e){s.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0445\u0430\u0434\u0433\u0430\u043b\u043b\u0430\u0430"),n(!1)}}),Z=(0,a.Z)(b,2),x=Z[0],M=Z[1].loading;return(0,S.jsx)(v.Z,{spinning:M,tip:"\u0410\u0447\u0430\u0430\u043b\u043b\u0430\u0436 \u0431\u0430\u0439\u043d\u0430...",children:(0,S.jsx)(y.Z,{id:"SchoolForm",layout:"vertical",form:i,name:"school",onFinish:function(e){e.program=t,x({variables:e})},children:(0,S.jsx)(y.Z.Item,{name:"subject",label:(0,S.jsx)(E.Z,{id:"subject"}),rules:[{required:!0,message:(0,S.jsx)(E.Z,{id:"form.required"})}],children:(0,S.jsx)(j.Z,{showSearch:!0,filterOption:!1,notFoundContent:g?(0,S.jsx)(c.Z,{cover:"content"}):(0,S.jsx)(w.Z,{image:w.Z.PRESENTED_IMAGE_SIMPLE}),onSearch:function(e){""===e?f([]):p({variables:{offset:0,limit:1e7,filter:e}})},children:u.map((function(e,t){return(0,S.jsxs)(I,{value:e.id,children:[e.subject," / ",e.content," / ",e.createUserid.lastName," ",e.createUserid.firstName]},t)}))})})})})};var P=function(e){var t=(0,r.useState)([]),n=(0,a.Z)(t,2),c=n[0],j=n[1],y=(0,r.useState)(""),w=(0,a.Z)(y,2),C=w[0],T=w[1],I=(0,o.k6)(),P=(0,i.a)(N.x5,{variables:{id:e.program}}),L=P.loading,O=P.refetch,R=P.data;(0,r.useEffect)((function(){!1===L&&R&&j(R.allProgramSubjectByProgram)}),[R,L]);var _=l.Z.confirm,H=(0,k.D)(N._j,{onCompleted:function(e){O(),s.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0443\u0441\u0442\u043b\u0430\u0430")}}),W=(0,a.Z)(H,1)[0],F=[{title:(0,S.jsx)(E.Z,{id:"subject"}),dataIndex:["subject","subject"],key:"subject",width:"40vw",sorter:function(e,t){return x.ZP.antdTableSorter(e,t,"subject")}},{title:(0,S.jsx)(E.Z,{id:"content"}),dataIndex:["subject","content"],key:"content",width:"40vw",sorter:function(e,t){return x.ZP.antdTableSorter(e,t,"subject")}},{title:(0,S.jsx)(E.Z,{id:"teacher"}),dataIndex:["subject","createUserid","firstName"],key:"teacher",width:"10vw",sorter:function(e,t){return x.ZP.antdTableSorter(e,t,"firstName")}}];e.permissions.destroy&&F.push({title:(0,S.jsx)(E.Z,{id:"main.action"}),key:"actions",dataIndex:"actions",width:"20vw",render:function(t,n){return(0,S.jsx)("div",{className:"text-center",children:!0===e.permissions.destroy&&(0,S.jsxs)(d.Z,{size:"small",onClick:function(){return e=n,void _({title:"\u0423\u0441\u0442\u0433\u0430\u0445 \u0443\u0443?",okText:"\u0423\u0441\u0442\u0433\u0430\u0445",okType:"danger",cancelText:"\u0411\u043e\u043b\u0438\u0445",onOk:function(){W({variables:{id:e.id}})}});var e},type:"text",icon:(0,S.jsx)(h.Z,{twoToneColor:"#f42f2f"}),children:[" ",(0,S.jsx)(E.Z,{id:"delete"})]})})}});var B=(0,r.useState)(!1),D=(0,a.Z)(B,2),z=D[0],U=D[1];return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(l.Z,{forceRender:!0,title:"edit"===C?(0,S.jsx)(E.Z,{id:"edit"}):(0,S.jsx)(E.Z,{id:"add_new"}),visible:z,okText:(0,S.jsx)(E.Z,{id:"main.okText"}),cancelText:(0,S.jsx)(E.Z,{id:"main.cancelText"}),onCancel:function(){U(!1)},okButtonProps:{form:"SchoolForm",key:"submit",htmlType:"submit"},children:(0,S.jsx)(M,{program:e.program,formType:C,setIsModalVisible:U})}),(0,S.jsx)(Z.Z,{alignItems:"center",justifyContent:"between",mobileFlex:!1,children:(0,S.jsx)(Z.Z,{mobileFlex:!1,children:(0,S.jsx)("div",{className:"text-right",children:(0,S.jsxs)(d.Z,{onClick:function(){return I.goBack()},type:"default",icon:(0,S.jsx)(p.Z,{}),block:!0,children:[" ",(0,S.jsx)(E.Z,{id:"back"})]})})})}),(0,S.jsxs)(u.Z,{className:"mt-3",children:[(0,S.jsxs)(Z.Z,{alignItems:"center",justifyContent:"between",mobileFlex:!1,children:[(0,S.jsx)(Z.Z,{className:"mb-1",mobileFlex:!1,children:(0,S.jsx)("div",{className:"mr-md-3 mb-3",children:(0,S.jsx)(f.Z,{placeholder:"\u0425\u0430\u0439\u0445",prefix:(0,S.jsx)(g.Z,{}),onChange:function(e){return function(e){var t=e.currentTarget.value,n=e.currentTarget.value?c:R.allProgramSubjectByProgram,r=x.ZP.wildCardSearch(n,t);j(r)}(e)}})})}),!0===e.permissions.create&&(0,S.jsx)("div",{className:"mr-md-3 mb-3",children:(0,S.jsxs)(d.Z,{onClick:function(){T("create"),U(!0)},type:"primary",icon:(0,S.jsx)(b.Z,{}),block:!0,children:[" ",(0,S.jsx)(E.Z,{id:"add_new"})]})})]}),(0,S.jsx)(v.Z,{spinning:L,children:(0,S.jsx)("div",{className:"table-responsive",children:(0,S.jsx)(m.Z,{columns:F,dataSource:c,size:"small",rowKey:"id",bordered:!0})})})]})]})},L=n(59288),O=n(59305),R=function(e){var t=(0,o.k6)(),n=(0,o.UO)(),r=(0,i.a)(N.Tr,{variables:{id:n.program}}),a=r.data,l=r.loading,s={create:(0,L.C)("add_program_subject"),edit:(0,L.C)("change_program_subject"),destroy:(0,L.C)("delete_program_subject")};return!1===l&&null===a.programById&&t.push("".concat(O.sH,"/programs")),l||Object.values(s).indexOf("loading")>-1?(0,S.jsx)(c.Z,{cover:"content"}):(0,S.jsx)(P,{title:e.title,permissions:s,program:a.programById.id})}},37295:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(1413),o=n(72791),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"},c=n(8711),a=function(e,t){return o.createElement(c.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:i}))};a.displayName="DownOutlined";var l=o.forwardRef(a)},31549:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(1413),o=n(72791),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},c=n(8711),a=function(e,t){return o.createElement(c.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:i}))};a.displayName="PlusCircleOutlined";var l=o.forwardRef(a)},53834:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(1413),o=n(72791),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M793 242H366v-74c0-6.7-7.7-10.4-12.9-6.3l-142 112a8 8 0 000 12.6l142 112c5.2 4.1 12.9.4 12.9-6.3v-74h415v470H175c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h618c35.3 0 64-28.7 64-64V306c0-35.3-28.7-64-64-64z"}}]},name:"rollback",theme:"outlined"},c=n(8711),a=function(e,t){return o.createElement(c.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:i}))};a.displayName="RollbackOutlined";var l=o.forwardRef(a)},14640:function(e,t,n){n.d(t,{Z:function(){return T}});var r=n(15671),o=n(43144),i=n(60136),c=n(29388),a=n(71002),l=n(72791),s=n(75314),d=n(10818),u=n(14937),f=n(69025);var v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return{};var n=t.element,r=void 0===n?document.body:n,o={},i=Object.keys(e);return i.forEach((function(e){o[e]=r.style[e]})),i.forEach((function(t){r.style[t]=e[t]})),o};var m={},h=function(e){if(document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth||e){var t="ant-scrolling-effect",n=new RegExp("".concat(t),"g"),r=document.body.className;if(e){if(!n.test(r))return;return v(m),m={},void(document.body.className=r.replace(n,"").trim())}var o=(0,f.Z)();if(o&&(m=v({position:"relative",width:"calc(100% - ".concat(o,"px)")}),!n.test(r))){var i="".concat(r," ").concat(t);document.body.className=i.trim()}}},p=n(93433),g=0,b=[],Z="ant-scrolling-effect",x=new RegExp("".concat(Z),"g"),j=new Map,y=(0,o.Z)((function e(t){var n=this;(0,r.Z)(this,e),this.lockTarget=void 0,this.options=void 0,this.getContainer=function(){var e;return null===(e=n.options)||void 0===e?void 0:e.container},this.reLock=function(e){var t=b.find((function(e){return e.target===n.lockTarget}));t&&n.unLock(),n.options=e,t&&(t.options=e,n.lock())},this.lock=function(){var e;if(!b.some((function(e){return e.target===n.lockTarget})))if(b.some((function(e){var t,r=e.options;return(null===r||void 0===r?void 0:r.container)===(null===(t=n.options)||void 0===t?void 0:t.container)})))b=[].concat((0,p.Z)(b),[{target:n.lockTarget,options:n.options}]);else{var t=0,r=(null===(e=n.options)||void 0===e?void 0:e.container)||document.body;(r===document.body&&window.innerWidth-document.documentElement.clientWidth>0||r.scrollHeight>r.clientHeight)&&(t=(0,f.Z)());var o=r.className;if(0===b.filter((function(e){var t,r=e.options;return(null===r||void 0===r?void 0:r.container)===(null===(t=n.options)||void 0===t?void 0:t.container)})).length&&j.set(r,v({width:0!==t?"calc(100% - ".concat(t,"px)"):void 0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden"},{element:r})),!x.test(o)){var i="".concat(o," ").concat(Z);r.className=i.trim()}b=[].concat((0,p.Z)(b),[{target:n.lockTarget,options:n.options}])}},this.unLock=function(){var e,t=b.find((function(e){return e.target===n.lockTarget}));if(b=b.filter((function(e){return e.target!==n.lockTarget})),t&&!b.some((function(e){var n,r=e.options;return(null===r||void 0===r?void 0:r.container)===(null===(n=t.options)||void 0===n?void 0:n.container)}))){var r=(null===(e=n.options)||void 0===e?void 0:e.container)||document.body,o=r.className;x.test(o)&&(v(j.get(r),{element:r}),j.delete(r),r.className=r.className.replace(x,"").trim())}},this.lockTarget=g++,this.options=t})),w=0,C=(0,u.Z)();var k={},N=function(e){if(!C)return null;if(e){if("string"===typeof e)return document.querySelectorAll(e)[0];if("function"===typeof e)return e();if("object"===(0,a.Z)(e)&&e instanceof window.HTMLElement)return e}return document.body},E=function(e){(0,i.Z)(n,e);var t=(0,c.Z)(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).container=void 0,o.componentRef=l.createRef(),o.rafId=void 0,o.scrollLocker=void 0,o.renderComponent=void 0,o.updateScrollLocker=function(e){var t=(e||{}).visible,n=o.props,r=n.getContainer,i=n.visible;i&&i!==t&&C&&N(r)!==o.scrollLocker.getContainer()&&o.scrollLocker.reLock({container:N(r)})},o.updateOpenCount=function(e){var t=e||{},n=t.visible,r=t.getContainer,i=o.props,c=i.visible,a=i.getContainer;c!==n&&C&&N(a)===document.body&&(c&&!n?w+=1:e&&(w-=1)),("function"===typeof a&&"function"===typeof r?a.toString()!==r.toString():a!==r)&&o.removeCurrentContainer()},o.attachToParent=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||o.container&&!o.container.parentNode){var t=N(o.props.getContainer);return!!t&&(t.appendChild(o.container),!0)}return!0},o.getContainer=function(){return C?(o.container||(o.container=document.createElement("div"),o.attachToParent(!0)),o.setWrapperClassName(),o.container):null},o.setWrapperClassName=function(){var e=o.props.wrapperClassName;o.container&&e&&e!==o.container.className&&(o.container.className=e)},o.removeCurrentContainer=function(){var e,t;null===(e=o.container)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(o.container)},o.switchScrollingEffect=function(){1!==w||Object.keys(k).length?w||(v(k),k={},h(!0)):(h(),k=v({overflow:"hidden",overflowX:"hidden",overflowY:"hidden"}))},o.scrollLocker=new y({container:N(e.getContainer)}),o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){var e=this;this.updateOpenCount(),this.attachToParent()||(this.rafId=(0,s.Z)((function(){e.forceUpdate()})))}},{key:"componentDidUpdate",value:function(e){this.updateOpenCount(e),this.updateScrollLocker(e),this.setWrapperClassName(),this.attachToParent()}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.visible,n=e.getContainer;C&&N(n)===document.body&&(w=t&&w?w-1:w),this.removeCurrentContainer(),s.Z.cancel(this.rafId)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.forceRender,r=e.visible,o=null,i={getOpenCount:function(){return w},getContainer:this.getContainer,switchScrollingEffect:this.switchScrollingEffect,scrollLocker:this.scrollLocker};return(n||r||this.componentRef.current)&&(o=l.createElement(d.Z,{getContainer:this.getContainer,ref:this.componentRef},t(i))),o}}]),n}(l.Component),T=E},69025:function(e,t,n){var r;function o(e){if("undefined"===typeof document)return 0;if(e||void 0===r){var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var n=document.createElement("div"),o=n.style;o.position="absolute",o.top="0",o.left="0",o.pointerEvents="none",o.visibility="hidden",o.width="200px",o.height="150px",o.overflow="hidden",n.appendChild(t),document.body.appendChild(n);var i=t.offsetWidth;n.style.overflow="scroll";var c=t.offsetWidth;i===c&&(c=n.clientWidth),document.body.removeChild(n),r=i-c}return r}function i(e){var t=e.match(/^(.*)px$/),n=Number(null===t||void 0===t?void 0:t[1]);return Number.isNaN(n)?o():n}function c(e){if("undefined"===typeof document||!e||!(e instanceof Element))return{width:0,height:0};var t=getComputedStyle(e,"::-webkit-scrollbar"),n=t.width,r=t.height;return{width:i(n),height:i(r)}}n.d(t,{Z:function(){return o},o:function(){return c}})},84376:function(e,t,n){n.d(t,{D:function(){return d}});var r=n(3431),o=n(72791),i=n(63124),c=n(5970),a=n(72364),l=n(29484),s=n(65046);function d(e,t){var n=(0,s.x)(null===t||void 0===t?void 0:t.client);(0,a.Vp)(e,a.n_.Mutation);var d=(0,o.useState)({called:!1,loading:!1,client:n}),u=d[0],f=d[1],v=(0,o.useRef)({result:u,mutationId:0,isMounted:!0,client:n,mutation:e,options:t});Object.assign(v.current,{client:n,options:t,mutation:e});var m=(0,o.useCallback)((function(e){void 0===e&&(e={});var t=v.current,n=t.client,o=t.options,a=t.mutation,s=(0,r.pi)((0,r.pi)({},o),{mutation:a});v.current.result.loading||s.ignoreResults||!v.current.isMounted||f(v.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:n});var d=++v.current.mutationId,u=(0,i.J)(s,e);return n.mutate(u).then((function(t){var r,o,i,a=t.data,s=t.errors,m=s&&s.length>0?new l.c({graphQLErrors:s}):void 0;if(d===v.current.mutationId&&!u.ignoreResults){var h={called:!0,loading:!1,data:a,error:m,client:n};v.current.isMounted&&!(0,c.D)(v.current.result,h)&&f(v.current.result=h)}return null===(o=null===(r=v.current.options)||void 0===r?void 0:r.onCompleted)||void 0===o||o.call(r,t.data,u),null===(i=e.onCompleted)||void 0===i||i.call(e,t.data,u),t})).catch((function(t){var r,o,i,a;if(d===v.current.mutationId&&v.current.isMounted){var l={loading:!1,error:t,data:void 0,called:!0,client:n};(0,c.D)(v.current.result,l)||f(v.current.result=l)}if((null===(r=v.current.options)||void 0===r?void 0:r.onError)||u.onError)return null===(i=null===(o=v.current.options)||void 0===o?void 0:o.onError)||void 0===i||i.call(o,t,u),null===(a=e.onError)||void 0===a||a.call(e,t,u),{data:void 0,errors:t};throw t}))}),[]),h=(0,o.useCallback)((function(){v.current.isMounted&&f({called:!1,loading:!1,client:n})}),[]);return(0,o.useEffect)((function(){return v.current.isMounted=!0,function(){v.current.isMounted=!1}}),[]),[m,(0,r.pi)({reset:h},u)]}}}]);
//# sourceMappingURL=9071.3d2246e5.chunk.js.map