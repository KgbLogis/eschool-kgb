"use strict";(self.webpackChunkemind=self.webpackChunkemind||[]).push([[5772],{68470:function(e,n,t){t(72791);var r=t(80184),i=function(e){var n=e.children,t=e.className,i=e.alignItems,s=e.justifyContent,o=e.mobileFlex,a=e.flexDirection;return(0,r.jsx)("div",{className:"".concat(o?"d-flex":"d-md-flex"," ").concat(t," ").concat(a?"flex-"+a:""," ").concat(i?"align-items-"+i:""," ").concat(s?"justify-content-"+s:""),children:n})};i.defaultProps={mobileFlex:!0,flexDirection:"row",className:""},n.Z=i},20077:function(e,n,t){t.d(n,{Di:function(){return Z},Gn:function(){return w},IR:function(){return P},JO:function(){return j},LZ:function(){return y},Lp:function(){return N},Mo:function(){return D},OM:function(){return C},Q7:function(){return v},Qe:function(){return b},SX:function(){return T},vm:function(){return I}});var r,i,s,o,a,c,d,l,u,m,$,g,h,S,p,x=t(30168),f=t(27570),Z=(0,f.Ps)(r||(r=(0,x.Z)(["\n    mutation createSchool($name: String, $nameMgl: String) {\n      createSchool(name: $name, nameMgl: $nameMgl) {\n        school {\n          id\n          name\n          nameMgl\n        }\n      }\n    }\n"]))),b=(0,f.Ps)(i||(i=(0,x.Z)(["\n    mutation createSubSchool($name: String, $nameMgl: String, $school: Int!){\n      createSubSchool(name: $name, nameMgl: $nameMgl, school: $school) {\n        subSchool {\n          id\n          name\n          nameMgl \n          school {\n            id\n          }\n        }\n      }\n    }\n"]))),j=((0,f.Ps)(s||(s=(0,x.Z)(["\n    mutation register($email: String!, $username: String!, $isTeacher: Boolean!, $isStudent: Boolean!, $password1: String!, $password2: String!){\n      register(email: $email, username: $username, isTeacher: $isTeacher, isStudent: $isStudent, password1: $password1, password2: $password2) {\n          success\n          errors\n          token\n      } \n    }\n\n"]))),(0,f.Ps)(o||(o=(0,x.Z)(["\n    mutation createTeacher($address: String, $birthCity: Int, $birthDistrict: Int, $birthdate: String, $degree: Int,\n                            $familyName: String, $joinBefore: String, $joinDate: String, $name: String, $phone: String, $phone2: String,\n                            $registerNo: String, $school: Int, $sex: String, $status: Int, $subSchool: Int, $teacherCode: String!,\n                            $username: String!, $password: String!, $email: String!, $access: String!\n                            # $user: Int\n                            ) {\n      createTeacher(address: $address, birthCity: $birthCity, birthDistrict: $birthDistrict, birthdate: $birthdate, degree: $degree,\n                             familyName: $familyName, joinBefore: $joinBefore, joinDate: $joinDate, name: $name, phone: $phone, phone2: $phone2, \n                            registerNo: $registerNo, school: $school, sex: $sex, status: $status, subSchool: $subSchool, \n                            teacherCode: $teacherCode, access: $access,\n                            username: $username, password: $password, email: $email\n                            # user: $user \n                            ) {\n        teacher {\n          id\n        }\n      }\n    }\n"])))),y=(0,f.Ps)(a||(a=(0,x.Z)(["\n    mutation createEmployee(\n                $address: String\n                $birthCity: Int\n                $birthDistrict: Int\n                $birthdate: String\n                $email: String!\n                $employeeCode: String!\n                $familyName: String\n                $group: Int\n                $name: String\n                $password: String!\n                $phone: String\n                $phone2: String\n                $photo: Upload\n                $registerNo: String\n                $sex: String\n                $status: Int\n                $compartment: Int\n                $username: String!\n              ) {\n      createEmployee(\n                address: $address\n                birthCity: $birthCity\n                birthDistrict: $birthDistrict\n                birthdate: $birthdate\n                email: $email\n                employeeCode: $employeeCode\n                familyName: $familyName\n                group: $group\n                name: $name\n                password: $password\n                phone: $phone\n                phone2: $phone2\n                photo: $photo\n                compartment: $compartment\n                registerNo: $registerNo\n                sex: $sex\n                status: $status\n                username: $username\n          ) {\n          employee {\n          id\n        }\n      }\n    }\n"]))),I=(0,f.Ps)(c||(c=(0,x.Z)(['\n    mutation createStudent($activity: Int, $address: String, $birthCity: Int, $birthDistrict: Int, $birthdate: String,\n                            $classes: Int, $classtime: Int, $familyName: String, $joinDate: String,\n                            $joinSchoolyear: String, $name: String, $nationality: String, $phone: String, $program: Int, \n                            $registerNo: String, $religion: String, $school: Int, $section: Int, $sex: String, $state: String, $status: Int, \n                            $statusExtra: Int, $surname: String, $studentCode: String,\n                            $username: String!, $password: String!) {\n      createStudent(activity: $activity, address: $address, birthCity: $birthCity, birthDistrict: $birthDistrict, birthdate: $birthdate, \n                    classes: $classes, familyName: $familyName, joinDate: $joinDate, name: $name, phone: $phone, \n                    registerNo: $registerNo, religion: $religion, school: $school, sex: $sex, status: $status,\n                    surname: $surname, studentCode: $studentCode, classtime: $classtime, joinSchoolyear: $joinSchoolyear, \n                    nationality: $nationality, program: $program, section: $section, state: $state, statusExtra: $statusExtra,\n                    username: $username, password: $password, email: "test@test.mn") {\n        student {\n          id\n        }\n      }\n    }\n']))),v=(0,f.Ps)(d||(d=(0,x.Z)(["\n  mutation createSection($classes: Int, $maxStudentNum: Int, $program: Int, $teacher: Int,  $school: Int, $section: String) {\n    createSection(classes: $classes, program: $program, school: $school, section: $section, maxStudentNum: $maxStudentNum, teacher: $teacher) {\n      section {\n        section\n      }\n    }\n  }\n"]))),P=(0,f.Ps)(l||(l=(0,x.Z)(["\n  mutation createClasses($activity: Int, $classes: String,\n                          $program: Int, $school: Int, $status: String) {\n    createClasses(activity: $activity, classes: $classes,\n                  program: $program, school: $school, status: $status) {\n      classes {\n        classes\n      }\n    }\n  }\n"]))),C=(0,f.Ps)(u||(u=(0,x.Z)(["\n    mutation createProgram($program: String, $programMgl: String,  \n                           $status: String, $maxStudentNum: Int, $school: Int, $subSchool: Int) {\n      createProgram(program: $program, programMgl: $programMgl,  \n                    status: $status, maxStudentNum: $maxStudentNum, school: $school, subSchool: $subSchool) {\n        program {\n          id\n        }\n      }\n    }\n"]))),N=(0,f.Ps)(m||(m=(0,x.Z)(["\n  mutation createSubject($credit: String, $subject: String, $content: String, $school: Int, $subSchool: Int) {\n    createSubject(credit: $credit, subject: $subject, school: $school, content: $content, subSchool: $subSchool) {\n      subject {\n        credit\n      }\n    }\n  }\n"]))),D=((0,f.Ps)($||($=(0,x.Z)(["\n  mutation createProgramSubject($program: Int, $subject: Int) {\n    createProgramSubject(program: $program, subject: $subject) {\n      programSubjectType {\n        id\n      }\n    }\n  }\n"]))),(0,f.Ps)(g||(g=(0,x.Z)(["\n  mutation createRoutineStudent ($routine: Int, $studentCode: String, $section: Int) {\n    createRoutineStudent (routine: $routine, studentCode: $studentCode, section: $section) {\n      routineStudent {\n        id\n      }\n    }\n  }\n"]))),(0,f.Ps)(h||(h=(0,x.Z)(["\n    mutation createParent ($address: String, $familyName: String, $name: String, $phone: String, $profession: String, $student: Int) {\n        createParent (address: $address, familyName: $familyName, name: $name, phone: $phone, profession: $profession, student: $student) {\n            parent {\n                name\n            }\n        }\n    }\n"])))),T=(0,f.Ps)(S||(S=(0,x.Z)(["\n    mutation createEventType ($color: String, $name: String) {\n        createEventType (color: $color, name: $name) {\n            eventType {\n                name\n            }\n        }\n    }\n"]))),w=(0,f.Ps)(p||(p=(0,x.Z)(["\n    mutation createEvent ($content: String, $description: String, $endAt: String, $eventType: Int, $startAt: String, $title: String) {\n        createEvent (content: $content, description: $description, endAt: $endAt, eventType: $eventType, startAt: $startAt, title: $title) {\n            event {\n                title\n            }\n        }\n    }\n"])))},64856:function(e,n,t){t.d(n,{BX:function(){return D},DO:function(){return j},Fo:function(){return P},Jk:function(){return k},MI:function(){return N},NH:function(){return Z},Tu:function(){return b},Ug:function(){return w},Xj:function(){return v},dc:function(){return C},mL:function(){return y},tc:function(){return I},xB:function(){return T}});var r,i,s,o,a,c,d,l,u,m,$,g,h,S,p,x=t(30168),f=t(27570),Z=((0,f.Ps)(r||(r=(0,x.Z)(["\n    mutation deleteCity($id: ID!){\n        deleteCity(id: $id){\n            city{\n              name\n              code\n            }\n        }\n    }\n"]))),(0,f.Ps)(i||(i=(0,x.Z)(["\n    mutation deleteAccount($username: String) {\n        deleteAccount(username: $username) {\n            account {\n                username\n            }\n        }\n    }\n"]))),(0,f.Ps)(s||(s=(0,x.Z)(["\n    mutation deleteTeacher($id: ID!){\n      deleteTeacher(id: $id){\n            teacher{\n              name\n            }\n        }\n    }\n"])))),b=(0,f.Ps)(o||(o=(0,x.Z)(["\n  mutation deleteEmployee($id: ID){\n    deleteEmployee(id: $id){\n      employee{\n        name\n      }\n    }\n  }\n  "]))),j=(0,f.Ps)(a||(a=(0,x.Z)(["\n  mutation deleteSubject ($id: ID) {\n    deleteSubject (id: $id) {\n      subject {\n        credit\n      }\n    }\n  }\n"]))),y=(0,f.Ps)(c||(c=(0,x.Z)(["\n    mutation deleteStudent($id: ID!){\n      deleteStudent(id: $id){\n            student{\n              surname\n            }\n        }\n    }\n"]))),I=(0,f.Ps)(d||(d=(0,x.Z)(["\n  mutation deleteSubSchool($id: ID){\n    deleteSubSchool(id: $id){\n      subSchool{\n        name\n      }\n    }\n}\n"]))),v=(0,f.Ps)(l||(l=(0,x.Z)(["\n  mutation deleteSchool($id: ID!){\n    deleteSchool(id: $id){\n      school{\n        name\n      }\n    }\n}\n"]))),P=(0,f.Ps)(u||(u=(0,x.Z)(["\n  mutation deleteSection($id: ID){\n    deleteSection(id: $id){\n      section{\n        section\n      }\n    }\n}\n"]))),C=(0,f.Ps)(m||(m=(0,x.Z)(["\n  mutation deleteClasses($id: ID!){\n    deleteClasses(id: $id){\n      classes{\n        classes\n      }\n    }\n}\n"]))),N=(0,f.Ps)($||($=(0,x.Z)(["\n    mutation deleteProgram($id: ID!){\n        deleteProgram(id: $id){\n            program{\n                program\n            }\n        }\n    }\n"]))),D=(0,f.Ps)(g||(g=(0,x.Z)(["\n    mutation deleteRoutine ($id: ID) {\n        deleteRoutine (id: $id) {\n            routine {\n                createdAt\n            }\n        }\n    }\n"]))),T=(0,f.Ps)(h||(h=(0,x.Z)(["\n    mutation deleteParent ($id: ID) {\n        deleteParent (id: $id) {\n            parent {\n                name\n            }\n        }\n    }\n"]))),w=(0,f.Ps)(S||(S=(0,x.Z)(["\n    mutation deleteEventType ($id: ID) {\n        deleteEventType (id: $id) {\n            eventType {\n                name\n            }\n        }\n    }\n"]))),k=(0,f.Ps)(p||(p=(0,x.Z)(["\n    mutation deleteEvent ($id: ID) {\n        deleteEvent (id: $id) {\n            event {\n                title\n            }\n        }\n    }\n"])))},55772:function(e,n,t){t.r(n),t.d(n,{default:function(){return F}});var r=t(72791),i=t(29439),s=t(20003),o=t(50419),a=t(87309),c=t(66871),d=t(49389),l=t(37083),u=t(59432),m=t(36795),$=t(82464),g=t(11730),h=t(31549),S=t(64880),p=t(68470),x=t(2703),f=t(22949),Z=t(73332),b=t(76835),j=t(84376),y=t(96578),I=t(41920),v=t(20077),P=t(82259),C=t(82630),N=t(80184),D=f.Z.Option;var T=function(e){var n=e.formType,t=e.editData,s=e.setIsModalVisible,a=Z.Z.useForm(),c=(0,i.Z)(a,1)[0],u=(0,j.D)(v.OM,{refetchQueries:[I.YP,"allPrograms"],onCompleted:function(e){o.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0445\u0430\u0434\u0433\u0430\u043b\u043b\u0430\u0430"),s(!1)}}),m=(0,i.Z)(u,2),$=m[0],g=m[1].loading,h=(0,j.D)(P.fG,{refetchQueries:[I.YP,"allPrograms"],onCompleted:function(e){o.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0445\u0430\u0434\u0433\u0430\u043b\u043b\u0430\u0430"),s(!1)}}),S=(0,i.Z)(h,2),p=S[0],x=S[1].loading,T=(0,y.a)(I.Fm,{}).data,w=(0,y.a)(I.O8,{}),k=w.data,M=w.loading,E=(0,r.useState)(void 0),F=(0,i.Z)(E,2),q=F[0],O=F[1];(0,r.useEffect)((function(){!1===M&&k&&O(k.allSubSchools)}),[q,k,M]),(0,r.useEffect)((function(){if("edit"===n){var e={program:t.program,programMgl:t.programMgl,maxStudentNum:t.maxStudentNum,school:t.school.id,subSchool:t.subSchool.id,status:t.status,key:t.id};c.setFieldsValue(e),R(c.getFieldValue("school"))}else"create"===n&&c.resetFields()}),[t,c,n]);var A=(0,r.useState)(""),_=(0,i.Z)(A,2),B=_[0],R=_[1],L=null,Q=null;return B&&(L=B),L&&(Q=null===q||void 0===q?void 0:q.filter((function(e){return e.school.id===L})).map((function(e){return(0,N.jsx)(D,{value:e.id,children:e.name},e.id)}))),(0,N.jsx)(l.Z,{spinning:g||x,tip:"\u0410\u0447\u0430\u0430\u043b\u043b\u0430\u0436 \u0431\u0430\u0439\u043d\u0430...",children:(0,N.jsxs)(Z.Z,{id:"ProgramForm",layout:"vertical",form:c,name:"control-hooks",onFinish:function(e){"edit"===n?(e.id=t.id,p({variables:e})):$({variables:e})},children:[(0,N.jsx)(Z.Z.Item,{name:"program",label:(0,N.jsx)(C.Z,{id:"name"}),rules:[{required:!0,message:(0,N.jsx)(C.Z,{id:"form.required"})}],children:(0,N.jsx)(d.Z,{})}),(0,N.jsx)(Z.Z.Item,{name:"programMgl",label:(0,N.jsx)(C.Z,{id:"nameMgl"}),rules:[{required:!0,message:(0,N.jsx)(C.Z,{id:"form.required"})}],children:(0,N.jsx)(d.Z,{})}),(0,N.jsx)(Z.Z.Item,{name:"school",label:(0,N.jsx)(C.Z,{id:"school"}),rules:[{required:!0,message:(0,N.jsx)(C.Z,{id:"form.required"})}],children:(0,N.jsx)(f.Z,{onChange:function(e){R(e)},children:null===T||void 0===T?void 0:T.allSchools.map((function(e,n){return(0,N.jsx)(D,{value:e.id,children:e.name},n)}))})}),(0,N.jsx)(Z.Z.Item,{name:"subSchool",label:(0,N.jsx)(C.Z,{id:"sub-school"}),rules:[{required:!0,message:(0,N.jsx)(C.Z,{id:"form.required"})}],children:(0,N.jsx)(f.Z,{placeholder:"\u0422\u044d\u043d\u0445\u0438\u043c \u0441\u043e\u043d\u0433\u043e\u0445",children:Q})}),(0,N.jsx)(Z.Z.Item,{name:"maxStudentNum",label:(0,N.jsx)(C.Z,{id:"maxStudentNum"}),rules:[{required:!0,message:(0,N.jsx)(C.Z,{id:"form.required"})}],children:(0,N.jsx)(b.Z,{})}),(0,N.jsx)(Z.Z.Item,{name:"status",label:(0,N.jsx)(C.Z,{id:"status"}),rules:[{required:!0,message:(0,N.jsx)(C.Z,{id:"form.required"})}],children:(0,N.jsxs)(f.Z,{placeholder:(0,N.jsx)(C.Z,{id:"status"}),children:[(0,N.jsx)(D,{value:"OPEN",children:"\u041d\u044d\u044d\u043b\u0442\u0442\u044d\u0439"},"1"),(0,N.jsx)(D,{value:"CLOSED",children:"\u0425\u0430\u0430\u043b\u0442\u0442\u0430\u0439"},"2")]})})]})})},w=t(64856);t(59305);var k=function(e){var n=(0,y.a)(I.YP,{}),t=n.loading,f=n.data,Z=((0,S.k6)(),(0,r.useState)(void 0)),b=(0,i.Z)(Z,2),v=b[0],P=b[1],D=(0,r.useState)(!0),k=(0,i.Z)(D,2),M=k[0],E=k[1],F=(0,r.useState)(!0),q=(0,i.Z)(F,2),O=q[0],A=q[1];(0,r.useEffect)((function(){!1===t&&f&&(P(f.allPrograms),E(!1),A(!1))}),[t,f,M]);var _=(0,r.useState)(!1),B=(0,i.Z)(_,2),R=B[0],L=B[1],Q=(0,r.useState)([]),V=(0,i.Z)(Q,2),Y=V[0],z=V[1],X=(0,r.useState)(""),G=(0,i.Z)(X,2),J=G[0],U=G[1],H=s.Z.confirm,K=Intl.NumberFormat(),W=(0,j.D)(w.MI,{refetchQueries:[I.YP,"allPrograms"],onCompleted:function(e){o.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0443\u0441\u0442\u043b\u0430\u0430")}}),ee=(0,i.Z)(W,1)[0],ne=[{key:"program",title:(0,N.jsx)(C.Z,{id:"name"}),dataIndex:"program",sorter:function(e,n){return x.ZP.antdTableSorter(e,n,"program")}},{key:"programMgl",title:(0,N.jsx)(C.Z,{id:"nameMgl"}),dataIndex:"programMgl",sorter:function(e,n){return x.ZP.antdTableSorter(e,n,"programMgl")}},{key:"school",title:(0,N.jsx)(C.Z,{id:"school"}),dataIndex:["school","name"],sorter:function(e,n){return x.ZP.antdTableSorter(e,n,"school")}},{key:"subSchool",title:(0,N.jsx)(C.Z,{id:"sub-school"}),dataIndex:["subSchool","name"],sorter:function(e,n){return x.ZP.antdTableSorter(e,n,"subSchool")}},{key:"maxStudentNum",title:(0,N.jsx)(C.Z,{id:"maxStudentNum"}),dataIndex:"maxStudentNum",sorter:function(e,n){return x.ZP.antdTableSorter(e,n,"maxStudentNum")},render:function(e){return(0,N.jsx)("span",{children:K.format(e)})}}];return(e.permissions.edit||e.permissions.destroy)&&ne.push({key:"actions",title:(0,N.jsx)(C.Z,{id:"main.action"}),dataIndex:"actions",width:"20vw",render:function(n,t){return(0,N.jsxs)("div",{className:"text-center",children:[!0===e.permissions.edit&&(0,N.jsxs)(a.Z,{size:"small",onClick:function(){return e=t,U("edit"),z(e),void L(!0);var e},type:"text",icon:(0,N.jsx)(m.Z,{twoToneColor:"#ffdb00"}),children:[" ",(0,N.jsx)(C.Z,{id:"edit"})]}),!0===e.permissions.destroy&&(0,N.jsxs)(a.Z,{size:"small",onClick:function(){return e=t,void H({title:"\u0423\u0441\u0442\u0433\u0430\u0445 \u0443\u0443?",okText:"\u0423\u0441\u0442\u0433\u0430\u0445",okType:"danger",cancelText:"\u0411\u043e\u043b\u0438\u0445",onOk:function(){ee({variables:{id:e.id}})}});var e},type:"text",icon:(0,N.jsx)($.Z,{twoToneColor:"#f42f2f"}),children:[" ",(0,N.jsx)(C.Z,{id:"delete"})," "]})]})}}),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(s.Z,{title:"edit"===J?(0,N.jsx)(C.Z,{id:"edit"}):(0,N.jsx)(C.Z,{id:"add_new3"}),visible:R,okText:(0,N.jsx)(C.Z,{id:"main.okText"}),cancelText:(0,N.jsx)(C.Z,{id:"main.cancelText"}),onCancel:function(){L(!1)},okButtonProps:{form:"ProgramForm",key:"submit",htmlType:"submit"},children:(0,N.jsx)(T,{setTableLoading:A,setReFill:E,formType:J,editData:Y,setIsModalVisible:L})}),(0,N.jsxs)(c.Z,{children:[(0,N.jsxs)(p.Z,{alignItems:"center",justifyContent:"between",mobileFlex:!1,children:[(0,N.jsx)(p.Z,{className:"mb-1",mobileFlex:!1,children:(0,N.jsx)("div",{className:"mr-md-3 mb-3",children:(0,N.jsx)(d.Z,{placeholder:"\u0425\u0430\u0439\u0445",prefix:(0,N.jsx)(g.Z,{}),onChange:function(e){return function(e){var n=e.currentTarget.value;n||E(!0);var t=v,r=x.ZP.wildCardSearch(t,n);P(r)}(e)}})})}),!0===e.permissions.create&&(0,N.jsx)("div",{className:"mr-md-3 mb-3",children:(0,N.jsxs)(a.Z,{onClick:function(){U("create"),L(!0)},type:"primary",icon:(0,N.jsx)(h.Z,{}),block:!0,children:[" ",(0,N.jsx)(C.Z,{id:"add_new"})]})})]}),(0,N.jsx)("div",{className:"table-responsive",children:(0,N.jsx)(l.Z,{spinning:O,children:(0,N.jsx)(u.Z,{columns:ne,size:"small",dataSource:v,rowKey:"id",bordered:!0})})})]})]})},M=t(59288),E=t(38937),F=function(e){var n={create:(0,M.C)("add_program"),edit:(0,M.C)("change_program"),destroy:(0,M.C)("delete_program"),view_program_subject:(0,M.C)("view_program_subject")};return Object.values(n).indexOf("loading")>-1?(0,N.jsx)(E.Z,{cover:"content"}):(0,N.jsx)(k,{title:e.title,permissions:n})}}}]);
//# sourceMappingURL=5772.a0941ee5.chunk.js.map